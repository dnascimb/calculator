<html>
<head>
<title>The Calculator</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="calculator.js"></script>
<script type="text/javascript">

	function calculateAndDisplay(cannabis_starting_thc_percentage, cannabis_cured_mass, butter_amount) {
		
		var calc = new Calculator();
		
		// set values for core variables
		calc.setOriginalPercentageSubA(cannabis_starting_thc_percentage);
		calc.setFinalSubAMass(cannabis_cured_mass);
		calc.setMassResultSubB(butter_amount);

		// set calculated values to display on screen
		$("#cured_suba_percentage").text(calc.getCuredSubAPercent() + "%");
		$("#cured_thc_mass_per_gram").text(calc.getCuredSubACalculatedMassPerGram() + "mg");
		$("#cured_thc_mass").text(calc.getCuredSubACalculatedMassTotal() + "mg");
		$("#butter_after_loss").text(calc.getSubBMassAfterInfusion() + "tbsp");
		$("#thc_per_g_butter").text(calc.getSubAMassPerSingleSubBMassUnit() + "mg");
		$("#suba_per_stick").text(calc.getSubAMassPerSpecificSubBMass(113) + "mg");
		$("#thc_per_serving").text(calc.getSubAMassPerNumberOfServings($.trim($("#cooking_butter_amount").val()), $.trim($("#recipe_servings").val())) + "mg");
	}

	$(document).ready(function(){
    	
    	$("#cured_mass").blur(function(){
    		console.log("hi");
        	calculateAndDisplay($.trim($("#suba_percentage").val()), $.trim($("#cured_mass").val()), $.trim($("#butter_amount").val()));
    	});
    	$("#suba_percentage").blur(function(){
        	calculateAndDisplay($.trim($("#suba_percentage").val()), $.trim($("#cured_mass").val()), $.trim($("#butter_amount").val()));
    	});
    	$("#butter_amount").blur(function(){
        	calculateAndDisplay($.trim($("#suba_percentage").val()), $.trim($("#cured_mass").val()), $.trim($("#butter_amount").val()));
    	});
		$("#cooking_butter_amount").blur(function(){
        	calculateAndDisplay($.trim($("#suba_percentage").val()), $.trim($("#cured_mass").val()), $.trim($("#butter_amount").val()));
    	});
    	$("#recipe_servings").blur(function(){
        	calculateAndDisplay($.trim($("#suba_percentage").val()), $.trim($("#cured_mass").val()), $.trim($("#butter_amount").val()));
    	});
    	


    	//protect the fields from bad user entry
    	// 48 = "0", 57 = "9", 127 = delete, 8 = backspace, 190 = ".", 9 = tab
    	$('#cured_mass').keydown(function(event){
    		var keycode = (event.keyCode ? event.keyCode : event.which);
    		if((keycode < 48 || keycode > 57) && keycode != 127 && keycode != 8 && keycode != 190 && keycode != 9) {
        		event.preventDefault();
   				return false;
   			}
    	});
    	$('#suba_percentage').keydown(function(event){
    		var keycode = (event.keyCode ? event.keyCode : event.which);
    		if((keycode < 48 || keycode > 57) && keycode != 127 && keycode != 8 && keycode != 190 && keycode != 9) {
        		event.preventDefault();
   				return false;
   			}
    	});
    	$('#butter_amount').keydown(function(event){
    		var keycode = (event.keyCode ? event.keyCode : event.which);
    		if((keycode < 48 || keycode > 57) && keycode != 127 && keycode != 8 && keycode != 190 && keycode != 9) {
        		event.preventDefault();
   				return false;
   			}
    	});
	});
</script>
</head>


<body>
	<div class="container">
        
        <br>
        &nbsp;
        <br>
        <br>
        &nbsp;
        <br>

        <h1>Basics</h1>
        <br>
		<div id="inputsection1" class="col-md-6">
			<form name="calcForm1">
				<label>Starting Cannabis THC|CBD Percentage: </label> 
				<input name="suba_percentage" id="suba_percentage" class="input" placeholder="20"/> %
				<br><br><label>Final Cannabis Mass: </label>
				<input name="cured_mass" id="cured_mass" class="input" placeholder="100"/> <label> grams </label>
			</form>
		</div>
		<div id="results1" class="col-md-6">
          <div class="panel panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title">THC|CBD %</h3>
            </div>
            <div class="panel-body">
              <label id="cured_suba_percentage">0%</label>
            </div>
          </div>
          <div class="panel panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title">THC|CBD Mass Per Gram</h3>
            </div>
            <div class="panel-body">
              <label id="cured_thc_mass_per_gram">0mg</label>
            </div>
          </div>

          <div class="panel panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title">THC|CBD Mass Total</h3>
            </div>
            <div class="panel-body">
              <label id="cured_thc_mass">0mg</label>
            </div>
          </div>
        </div>

        <br>
        &nbsp;
        <br>
        <br>
        &nbsp;
        <br>
        <hr>
        <br>
        &nbsp;
        <br>

        <h1>Butter Infusion</h1>
        <div id="inputsection2" class="col-md-6">
			<form name="calcForm2">
				<br><br><label>Starting Butter Amount: </label> 
				<input name="butter_amount" id="butter_amount" class="input" placeholder="10.64"/> <label> tablespoons </label>
			</form>
		</div>
		<div id="results2" class="col-md-6">
          <div class="panel panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title">Butter After Loss (-25%)</h3>
            </div>
            <div class="panel-body">
              <label id="butter_after_loss">0tbsp</label>
            </div>
          </div>
          <div class="panel panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title">THC|CBD per g Butter</h3>
            </div>
            <div class="panel-body">
              <label id="thc_per_g_butter">0mg</label>
            </div>
          </div> 
          <div class="panel panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title">THC|CBD in a Full Stick of Butter</h3>
            </div>
            <div class="panel-body">
              <label id="suba_per_stick">0mg</label>
            </div>
          </div>         
		</div>

        <br>
        &nbsp;
        <br>
        <br>
        &nbsp;
        <br>
        <hr>
        <br>
        &nbsp;
        <br>

        <h1>Baking with Butter</h1>
		<div id="inputsection3" class="col-md-6">
			<form name="calcForm3">
				<br><br><label>Butter Amount: </label> 
				<input name="cooking_butter_amount" id="cooking_butter_amount" class="input" placeholder="4"/> <label> tablespoons </label>
				<br><br><label>Recipe Number of Servings: </label> 
				<input name="recipe_servings" id="recipe_servings" class="input" placeholder="12"/>
			</form>
		</div>
		<div id="results3" class="col-md-6">
          <div class="panel panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title">THC|CBD per Serving</h3>
            </div>
            <div class="panel-body">
              <label id="thc_per_serving">0mg</label>
            </div>
          </div>
		</div>
	</div>
</body>


</head>
